%\documentclass[11pt, a4paper, utf8x]{article}
%\documentclass[11pt, a4paper]{article}
\documentclass{iacas}
%
%\usepackage[utf8x]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{times}
\usepackage{color}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{latexsym}
\usepackage{subcaption}
\usepackage{commath}
\usepackage{tikz}
\usepackage{hyperref}% embedding hyperlinks [must be loaded after dropping]
\usepackage{cleveref}
\usepackage{enumitem}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
%\usepackage[english,hebrew]{babel}
%\usepackage{hebfont}
\captionsetup{compatibility=false}

%\usepackage[margin=2cm]{geometry}

%--Tikz defenitions--%
\usetikzlibrary{positioning}
\tikzset{main node/.style={circle,draw,minimum size=0.5cm,inner sep=0pt}}

\usepackage{amsmath}
%\usepackage{soul,color}
\usepackage{threeparttable}% tables with footnotes
\usepackage{dcolumn}% decimal-aligned tabular math columns

%--COMMANDS--%
\newcommand{\rsqr}{\mathbb{R}^2}
\newcommand{\rthrd}{\mathbb{R}^3}
\newcommand{\eqsn}[1]{\begin{equation}#1\end{equation}}
\newcommand{\br}{$\\ $}

\newcommand{\bmat}[1]{\begin{bmatrix}#1\end{bmatrix}}
\newcommand{\mat}[1]{\begin{matrix}#1\end{matrix}}
\newcommand{\vmat}[1]{\begin{vmatrix}#1\end{vmatrix}}

\newcommand{\con}{c\left(t\right)}
\newcommand{\conp}[1]{c_{#1}\left(t\right)}
\newcommand{\concov}{\mathtt{C}\left(\con\right)}
\newcommand{\concovp}[1]{\mathtt{C}\left(\conp{#1}\right)}
\newcommand{\conset}{\mathtt{G}}

\DeclareRobustCommand{\rchi}{{\mathpalette\irchi\relax}}
\newcommand{\irchi}[2]{\raisebox{\depth}{$#1\chi$}} % inner command, used by \rchi

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{assumption}{Assumption}
\newtheorem{remark}{Remark}
\newtheorem{proposition}{Proposition}
\newtheorem{corollary}{Corollary}
\newtheorem{example}{Example}
\newtheorem{definition}{Definition}
\newtheorem{problem}{Problem}


\begin{document}
%--TITLE--%
\newcolumntype{d}{D{.}{.}{-1}}

\title{A Projected Lloyd's Algorithm for Coverage Control Problems}

\author{%
  Yoav Palti\thanks{Faculty of Aerospace Engineering, Technion - Israel Institute of Technology, Haifa, yoavp10@gmail.com}
  \ and
  Daniel Zelazo\thanks{Associate Professor, Faculty of Aerospace Engineering, Technion - Israel Institute of Technology, Haifa, dzelazo@technion.ac.il}
}

\maketitle

\begin{abstract}
This work presents a new approach for a coverage problem for large areas and a limited number of sensors. We consider the problem where there are not enough sensors to provide complete coverage of the designated area at once, and therefore the sensors should coordinate their coverage in a sequential manner.  Furthermore, we require that at each stage of coverage, a sub-region in the area is constantly monitored. Our solution approach is a combination of two algorithms, the first one is Lloyd's algorithm, which is well known and used in this field, and the second one is a modified Lloyd's algorithm that we term the \emph{projected Lloyd's Algorithm}. Lastly, we combine Lloyd's algorithm (and its projected version) with a distance based formation controller. We demonstrate our results with numerical simulations.
\end{abstract}

\section{Introduction}

The mission of monitoring some range (for example, area) using sensors is widely spread in various fields - it can be used for photographing a large area, receiving or sending electromagnetic signals, tracking targets, or even for designing an algorithm for a robotic vacuum cleaner \cite{Nigam2012, 7798796, 7798244}.
%
This research area is known in the scientific community as the \emph{coverage control} problem \cite{Cassandras2005}. Sensor coverage can be generally described as the reflection of how well a given range is monitored by sensors. This field is well explored in the scientific community, especially in the recent years when the fields of distributed algorithms and cooperative systems were developed.

A concept that repeats in many researches is finding a set of trajectories (at least one route for every sensor), allowing the mobile sensors to achieve the required coverage goal.  For example, when trying to cover an area using two mobile sensors, the algorithm will define a trajectory for each sensor such that the whole area will be covered \cite{Atinc2013,Hussein2007}.
Another idea that appears in most of the relevant literature is the use of Voronoi diagrams for optimizing the sensor location \cite{Cortes2004,Hussein2007}. 

When coverage is required for large areas, and specifically when a single sensor cannot provide full coverage of that area, the idea of using a \emph{deployment} of mobile sensors is presented \cite{Cassandras2005, Cortes2004}. In \cite{Cassandras2005}, the problem is formed using a probabilistic network model and some density function, to model evens. Then, an optimization algorithm is proposed to find the optimal deployment such that maximum coverage is obtained with minimal communications cost. On \cite{Cortes2004}, Cortes \textit{et al.} propose an optimization algorithm for maximal coverage using Centroidal Voronoi Tessellations \cite{Du1999}. The former concept will be utilized and modified in this paper to achieve new coverage capabilities that will be further described.

In this work, we formulate the coverage problem from another angle. We firstly assume that the given range can be at most \emph{partially} covered, however we also define some sub-range that must be at least partially covered at all times (for example, surveillance or home-base communications constraint). We present an algorithm for partitioning this range into tiles, such that each tile intersects with this sub-range constraint, and then, utilizing \cite{Cortes2004} method to achieve coverage of this tile. This method has two main benefits - first, we can achieve full coverage if we \emph{sequentially} moving the agents from tile to tile, and second - the operator can return the agents to any tile whenever he desires to.

There are some cases where maintaining spatial properties is important. One example is when the communications between the sensors are limited to some range. Another example is when the spatial shape is critical for the mission, as in geolocation missions. A well known solution for this problem is the distance-based formation control \cite{Krick2008, Kwang-KyoOh2011}. 
\br

Following this chapter, the problem will be formally defined. Then, mathematical background on the main concepts of this paper will be given, followed by the solution algorithms and control strategies. Finally, numerical simulations will be shown.

\section{Problem Formulation}
Let us consider an area $A \subset \rsqr$ that we aim to cover with $n \in \mathbb{N}$ \emph{mobile} sensors. Those sensors are defined as the set $S = \{s_1, \ldots, s_n\}$ located at positions $P(t) = \{ p_i (t) \in \rsqr \mid i = 1,\; \ldots ,\; n\}$:
\begin{itemize}
\item The mobile sensors are modelled using integrator dynamics $\dot{p_i}(t)=u$.
\item Each sensor can cover a region described by the abstract set $C_i \left( p_i(t) \right) \subset \rsqr$.
\end{itemize}

\begin{figure}[H]
\centering
\includegraphics[scale=0.6]{figures/problem-def/sensor-and-coverage.png}
\caption{A sensor and its coverage region}
\end{figure}

\subsection{Configuration}
A configuration $c$ of the mobile sensors at time $t$ is the stack of the sensor positions at time $t$:
\begin{equation*}
c\left(t\right) = \bmat{
p_{1}^{T}\left(t\right)&\cdots&p_{n}^{T}\left(t\right)}^{T}\in\mathbb{R}^{2n}
\end{equation*}
Thus the coverage of a configuration:
\begin{equation*}
D\left( c\left( t \right) \right) = \cap C_i(p_i(t))
\end{equation*}
Let us consider a sub-area of $A,\; A_m \subset A$ which must be partially covered (e.g. ground station).

\begin{assumption}
$D\left( c\left( t \right) \right) \subset A$ - a single configuration \emph{can't} provide full coverage!
\end{assumption}

\begin{figure}[H]
\centering
	\begin{subfigure}[b]{0.3\textwidth}
		\includegraphics[width=\textwidth]{figures/problem-def/config-1.png}
	\end{subfigure}
	\hspace{0.75cm}
	\vline
	\hspace{0.75cm}
	\begin{subfigure}[b]{0.3\textwidth}
		\includegraphics[width=\textwidth]{figures/problem-def/config-2.png}
	\end{subfigure}
	\caption{Two configurations built from the same sensors set}
	\label{fig:configurationsExample}
\end{figure}


\subsection{Partition}
The partition of $A \in \rsqr$, $PR(A)$, is a finite set built from $n$ subset $pr_i \subset \rsqr,\; i=1,\; \ldots,\; n$ such that:
\begin{itemize}
\item $pr_i \cap pr_j = \emptyset \; \forall i \neq j$.
\item $\cup pr_i = A$.
\end{itemize}

\begin{figure}[!ht]
\centering
\includegraphics[scale=0.4]{figures/problem-def/partitioning.png}
\caption{An example of a partition of some area}
\end{figure}

\subsection{Problem Definition}
\begin{problem} \label{GeneralProblem}
\begin{enumerate}
\item Find a partition $PR(A)$ such that each subsets $pr_i \in PR(A), \; pr_i \cap A_m \neq \emptyset$
\item Find a deployment controller, such that $$ pr_i \subseteq \lim_{t\rightarrow \infty}D(c(t)),\text{for }i=1,\ldots,n.$$
\end{enumerate}
\end{problem}


\section{Voronoi Diagrams and Distributed Coverage Algorithms}
%\textcolor{red}{(provide short paragraph summarizing what you will talk about here)}
In this chapter we will introduce two main concepts that were used in this work. First, Voronoi Diagrams, and later Lloyd's algorithm.
\subsection{Voronoi Diagrams}
The basic mathematical concept that we employ in this work is the \emph{Voronoi Diagram} (also known as Voronoi partition or Voronoi tessellation). While being a method to partition an area with some cost function, it is a widely-used in the optimal coverage problem \cite{Cortes2004,Hussein2007, Du1999}. The Voronoi Diagram of a region $\Omega \subset \rsqr$ is the set of partitions $\mathcal{V} = \left\{V_{i} \mid \cup V_{i} = \Omega\right\}$, generated by the generators $\mathcal{Z} = \{z_1,\ldots,z_n\mid z_{i} \in \Omega\}$, such that
\begin{equation} \label{Voronoi Definition}
V_{i} = \{q\in\Omega \mid \norm{q - z_i} \leq \norm{q - z_j} \forall z_i,z_j\in\mathcal{Z}\},
\end{equation}
where $V_{i}$ corresponds to the $i$-th element of $\mathcal{Z}$, and $\norm{\cdot}$ denotes the Euclidean distance.

A more intuitive and non-formal definition of the Voronoi Diagram is as follows. If we take some area and place points $p_i$ in it, then each partition is the set of all points that are closer to $p_i$ than $p_j$, when $j \neq i$. An example is the problem where there are post offices in some city, and it is needed to decide which house will be served by which specific post office. Using Voronoi partitioning, we can determine which houses are the nearest to each office and therefore conclude which houses each branch will serve.

\subsubsection*{Centroidal Voronoi Tessellation}
One can define a density function, $\rho_i$, for each Voronoi partition $V_{i}$. Then, we can define the center of mass for each partition as:
\begin{equation}
z_{i}^{*} = \frac{\int_{V_{i}}y\rho(y)dy}{\int_{V_{i}}\rho(y)dy}
\end{equation}
If a generator $z_{i} = z_{i}^{*} \, \forall \,V_{i}$, we call this partitioning a \emph{centroidal Voronoi tessellation} (CVT). Such tessellations are useful in terms of location optimization \cite{Cortes2004,Du1999,Atinc2013}.
A Voronoi tessellation illustration can be seen in Figure~\ref{fig:Voronoi_tessellation_illustration}. 

While Voroni diagrams are useful for partitioning some existing range, CVT is a technique used for (but not only) for \textit{planning} in an optimal way. If in the Voronoi diagram explanation, it was used to plan the delivery areas for each office, we will use the CVT to find where are the optimal locations to place the post offices!

\begin{figure}
	\captionsetup[subfigure]{position=b}
	\centering
	\subcaptionbox{Voronoi Diagram.}{\includegraphics[width=.48\linewidth]{figures/math-bg/voronoi.png}}
	\subcaptionbox{Centroidal Voronoi Tessellations. The points represent the center of mass, calculated using the density function $\phi = 1$.}{\includegraphics[width=.48\linewidth]{figures/math-bg/cvt.png}}
	\caption{Illustration of Voronoi Diagram and a CVT, both from the same initial conditions}
\label{fig:Voronoi_tessellation_illustration}
\end{figure}

As can be seen in equation (\ref{Voronoi Definition}), the calculation of each Voronoi cell for some agent depends on the other agents positions. Therefore, any sort of calculation required \emph{sharing information}. This can be done in a centralized approach (as it was done for this research), but there exists also decentralized calculations, for example \cite{Adams2009}. Using decentralized calculation, each agent have to have the info only on their neighbours (or any limited amount of agents), which allows for calculating huge networks, in dynamic situations where agents can, for example, connect and disconnect from the network in real time.

\subsection{Lloyd's Algorithm}
As mentioned above, the CVT's are very useful for locational optimization. However, calculating the CVT might be a complicated task. Lloyd proposed a very simple way of calculating the CVT \cite{Lloyd1982}, presented in Alogirthm \ref{LloydAlgo}. 
\begin{algorithm}
\caption{Lloyd's Algorithm}\label{LloydAlgo}
\begin{algorithmic}[1]
\State Calculate the Voronoi diagram for the current agents positions.
\State Calculate the center of mass for every cell.
\State Move the agents to the center of mass.
\State Repeat until converge.
\end{algorithmic}
\label{algo:lloyd's algorithm}
\end{algorithm}

\subsubsection*{Continuous-time Lloyd's Algorithm}
Cortes et al. proposed a control algorithm based on Lloyd's algorithm. According to \cite{Cortes2004}, let us define agent $i$ position as $p_i$ and the $i$'s partition centroid as $C_{V_{i}}$. Of course, this centroid is defined for some given density function, which allow us a degree of freedom in the calculations. For some proportional constant $k_{prop}$, the controller can be defined as:
\begin{equation} \label{LloydsContol}
u_{i} = -k_{prop}\left( p_i - C_{V_{i}} \right)
\end{equation} 

Cortes et al. also proved that the controller~(\ref{LloydsContol}) is locally asymptotic stable. It can be proved using the Direct Lyaponuv method, and the proof is given on \cite{Cortes2004}.


\section{Proposed Solution}

In this chapter, problem (\ref{GeneralProblem}) will be addressed. First, we will propose an algorithm to address the special partition requirements, and then a solution for the whole problem will be shown.

\subsection{Projected Lloyd's Algorithm}
A short reminder to the first part of the problem:
\emph{Partition the area $A$ such that $pr_i \cap A_m \neq \emptyset$}.

To show the solution, we will first define a \emph{Projection} onto the area $A_m$:
\begin{definition}
$$\textsc{proj}_{A_m}(x) = \arg\min_{y \in A_m} \norm{x-y}^2$$
\label{def:projection operator}
\end{definition}

Applying the projection operator in conjuction with Lloyd's algorithm yield the \emph{Projected Lloyd's Algorithm} (PLA):
\begin{algorithm}
\caption{Projected Lloyd's Algorithm}\label{ProjLloydsAlgorithm}
\begin{algorithmic}[1]
\State Calculate the Voronoi diagram for the current agents positions.
\State Calculate the center of mass for every cell.
\State Project the center of mass of every cell to the area constraint limiting polygon.
\State Move the agents the projected center of mass.
\State Repeat until converge.
\end{algorithmic}
\label{algo:PLA}
\end{algorithm}

As one can see, we added two more steps over the original Lloyd's algorithm - where we project the cell center of mass to the polygon that defines the area constraint (steps number 3-4), and then moving the agents to those points. Those step allows us to ensure that at least one agent will be \emph{on} the limiting polygon, thus we will have coverage within the constraint.

This algorithm can be also formed in a continuous time form, based of (\ref{LloydAlgo}):
\begin{equation} \label{ProjectedLloydsContol}
u_{i} = -k_{prop}\left( p_i - \textit{proj}\left( C_{V_{i}} \right) \right)
\end{equation} 

\begin{figure}
	\captionsetup[subfigure]{position=b}
	\centering
	\subcaptionbox{CVT calculated using Lloyd's algorithm}{\includegraphics[width=.48\linewidth]{figures/proposed-sol/proj-lloyds-off.eps}}
	\subcaptionbox{PLA solution}{\includegraphics[width=.48\linewidth]{figures/proposed-sol/proj-lloyds-on.eps}}
	\caption{CVT and PLA solutions for initial conditions. The black box represents $A_m$.}
\label{fig:Voronoi_tessellation_illustration}
\end{figure}

\subsubsection*{Stability of the Projected Lloyd's Algorithm}
\begin{theorem}
The controller proposed in (\ref{ProjectedLloydsContol}) is locally asymptotic stable.
\end{theorem}

\begin{proof}
TODO!
\end{proof}

One can notice a major difference between PLA and Loyd's algorithm - while Lloyd's algorithm is an optimal calculation (that converge to some local minima), the PLA is \emph{some} solution, and we do not provide any optimal condition.

\subsection{Full Problem Solution Algorithm}
The PLA is answering the question of how to partition such that $pr_i \cap A_m \neq \emptyset$. The second part of the problem, which requires a deployment controller, was answered in \cite{Cortes2004}. It is possible to utilized their solution, proposing a solution algorithm for problem (\ref{GeneralProblem}).

\begin{algorithm}[H]
\caption{Problem (\ref{GeneralProblem}) Solution Algorithm}\label{GeneralProbSolution}
\begin{algorithmic}[1]
\State Using some random initial guess, calculate the PLA for the whole area.
\State For each partition (assuming that the agents can actually cover each partition with their coverage radius), calculate the CVT. The initial positions for the CVT calculation is the previous partition CVT.
\end{algorithmic}
\label{algo:problem solution algorithm}
\end{algorithm}

We should notice the following things:
\begin{enumerate}
\item In stage 1, the number of the partition that the area will be divided to is somewhat arbitrary.
\item In stage 2, we assume that the coverage radius of the agents is big enough to cover the whole partition. If it's not the case, then we can dived the area for more partitions in stage 1. Some more advanced work can propose an algorithmic solution for this problem.
\item The Voronoi diagram can be calculated even if the agents are outside of the required area. It does require sometimes more iterations.
\item This version of the algorithm is centralized.
\end{enumerate}


\subsection{Results}
In this sub-section, we will show results for problem (\ref{GeneralProblem}), using algorithm \ref{algo:problem solution algorithm}.

In the following simulations, the initial conditions were identical.

\subsubsection{Results \emph{without} PLA}
\begin{figure}[H]
\includegraphics[scale=0.8]{figures/proposed-sol/results/sim1-3agents-3partitions-noPLA.eps}
\label{fig:results:no PLA}
\caption{Results without PLA. The box represents $A_m$}
\end{figure}

In figure \ref{fig:results:no PLA}, we can see a simulation ran for 3 agents. The area is partitioned into 3 tiles using Lloyd's algorithm (that is CVT), and each tile is covered using the algorithm proposed in \cite{Cortes2004}. The agents moved between the tiles in arbitrary order, and one can notice that only in the last step there was coverage of $A_m$.

\subsubsection{Results \emph{with} PLA}
\begin{figure}[H]
\includegraphics[scale=0.8]{figures/proposed-sol/results/sim2-3agents-3partitions-PLA.eps}
\label{fig:results:PLA}
\caption{Results with PLA. The box represents $A_m$}
\end{figure}

In figure \ref{fig:results:PLA}, we can see a simulation ran for 3 agents. The area is partitioned into 3 tiles using Projected Lloyd's algorithm, and each tile is covered using the algorithm proposed in \cite{Cortes2004}. The agents moved between the tiles in arbitrary order, and each tile has some partial coverage of $A_m$.

\section{Combining Lloyd's Algorithm and Formation Control}

\section{Concluding Remarks}
%The Coverage Problem is well known and researched. This work provides a new approach for the common problem of not having enough sensors, and deals with it from a static point of view, while maintaining coverage on some constrained area.\\
%The proposed solution is a simple control law which, under the work assumption, solves the problem. The simplicity of the control law, all together with the fact its stability, open the way for combining it with other control laws in some future work, which might lead to some interesting results. For example, combining this controller with a formation control controller, together with calculating the Voronoi in a distributed way, can lead to some interesting results for autonomous, dynamically changed swarms.
%\textcolor{red}{add concluding statements - including idea of using formation control in work)}
\bibliography{bibliography}
\bibliographystyle{iacas}
\end{document}
